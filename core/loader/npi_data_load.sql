/*
NPI_DATA_LOAD.SQL
Targeter v1
MySQL 5.7.32 Database
jchapman - created: 3.18.2022 modified: 3.19.2022
Script that creates npi data tables and loads data from .csv files.

DO NOT USE THIS SCRIPT IF WORKING IN THE AZURE CLOUD. USE ETL PROCESSES BUILT IN DATA FACTORY TO LOAD NPI DATA.
*/

/*
-- create table for and load othername_pfile_
CREATE TABLE npi_otherorgnames (
othername_id INT AUTO_INCREMENT PRIMARY KEY,
npi INT,
prov_othr_org_name varchar(120),
prov_othr_org_name_type varchar(1));
*/

LOAD DATA INFILE '/Users/jchapman/Downloads/NPPES_Data_Dissemination_September_2022/othername_pfile_20050523-20220911.csv' IGNORE INTO TABLE npi_otherorgnames
FIELDS TERMINATED BY ',' ENCLOSED BY '"'
LINES TERMINATED BY '\n'
IGNORE 1 LINES
(npi, prov_othr_org_name, prov_othr_org_name_type);

-- SELECT * FROM npi_otherorgnames;

/*
-- create table for and load pl_pfile_
CREATE TABLE npi_otherpraclocations (
other_prac_loc_id INT AUTO_INCREMENT PRIMARY KEY,
npi INT,
address_line_1 varchar(55),
address_line_2 varchar(55),
city varchar(40),
state varchar(40),
postal_code varchar(20),
country varchar(2),
telephone_nbr varchar(20),
telephone_ext varchar(5),
fax_nbr varchar(20));
*/

LOAD DATA INFILE '/Users/jchapman/Downloads/NPPES_Data_Dissemination_September_2022/pl_pfile_20050523-20220911.csv' IGNORE INTO TABLE npi_otherpraclocations
FIELDS TERMINATED BY ',' ENCLOSED BY '"'
LINES TERMINATED BY '\n'
IGNORE 1 LINES
(npi, address_line_1, address_line_2, city, state, postal_code, country, telephone_nbr, telephone_ext, fax_nbr);

-- SELECT * FROM npi_otherpraclocations;

/*
-- create table for and load endpoint_pfile_
CREATE TABLE npi_endpoints (
endpoint_id INT AUTO_INCREMENT PRIMARY KEY,
npi INT,
endpoint_type varchar(50),
endpoint_type_desc varchar(255),
endpoint varchar(1000),
affiliation varchar(1),
endpoint_desc varchar(1000),
affiliation_legal_bus_name varchar(70),
use_code varchar(25),
use_desc varchar(100),
other_use_desc varchar(200),
content_type varchar(25),
content_desc varchar(100),
other_content_desc varchar(200),
affiliation_address_line_1 varchar(55),
affiliation_address_line_2 varchar(55),
affiliation_address_city varchar(40),
affiliation_address_state varchar(40),
affiliation_address_country varchar(2),
affiliation_address_postal_code varchar(55));
*/

LOAD DATA INFILE '/Users/jchapman/Downloads/NPPES_Data_Dissemination_September_2022/endpoint_pfile_20050523-20220911.csv' IGNORE INTO TABLE npi_endpoints
FIELDS TERMINATED BY ',' ENCLOSED BY '"'
LINES TERMINATED BY '\n'
IGNORE 1 LINES
(npi, endpoint_type, endpoint_type_desc, endpoint, affiliation, endpoint_desc, affiliation_legal_bus_name, use_code, use_desc, other_use_desc, content_type, content_desc, other_content_desc, affiliation_address_line_1, affiliation_address_line_2, affiliation_address_city, affiliation_address_state, affiliation_address_country, affiliation_address_postal_code);

-- SELECT * FROM npi_endpoints;

/*
-- create table for and load npidata_pfile_

-- allow for large table creation. RUN THE NEXT TWO 'SET' STATEMENTS SEPARATELY!!
SET GLOBAL innodb_default_row_format='dynamic';
SET SESSION innodb_strict_mode=OFF;

CREATE TABLE npi_npidata (
npidata_id INT AUTO_INCREMENT PRIMARY KEY,
npi INT,
entity_type_code INT,
replacement_npi INT,
employ_id_nbr varchar(9),
prov_org_name varchar(70),
prov_last_name varchar(35),
prov_first_name varchar(20),
prov_middle_name varchar(20),
prov_name_prefix varchar(5),
prov_name_suffix varchar(5),
prov_cred_text varchar(20),
c12 varchar(70),
c13 varchar(1),
c14 varchar(35),
c15 varchar(20),
c16 varchar(20),
c17 varchar(5),
c18 varchar(5),
c19 varchar(20),
c20 INT,
c21 varchar(55),
c22 varchar(55),
c23 varchar(40),
c24 varchar(40),
c25 varchar(20),
c26 varchar(2),
c27 varchar(20),
c28 varchar(20),
c29 varchar(55),
c30 varchar(55),
c31 varchar(40),
c32 varchar(40),
c33 varchar(20),
c34 varchar(2),
c35 varchar(20),
c36 varchar(20),
c37 varchar(10),
c38 varchar(10),
npi_deactivation_reason_code varchar(2),
npi_deactivation_date varchar(10),
npi_reactivation_date varchar(10),
prov_gender_code varchar(1),
c43 varchar(35),
c44 varchar(20),
c45 varchar(20),
authorized_official_title varchar(35),
authorized_official_phone_nbr varchar(20),
health_prov_taxonomy_code_1 varchar(10),
c49 varchar(20),
c50 varchar(2),
c51 varchar(1),
health_prov_taxonomy_code_2 varchar(10),
c53 varchar(20),
c54 varchar(2),
c55 varchar(1),
health_prov_taxonomy_code_3 varchar(10),
c57 varchar(20),
c58 varchar(2),
c59 varchar(1),
health_prov_taxonomy_code_4 varchar(10),
c61 varchar(20),
c62 varchar(2),
c63 varchar(1),
health_prov_taxonomy_code_5 varchar(10),
c65 varchar(20),
c66 varchar(2),
c67 varchar(1),
health_prov_taxonomy_code_6 varchar(10),
c69 varchar(20),
c70 varchar(2),
c71 varchar(1),
health_prov_taxonomy_code_7 varchar(10),
c73 varchar(20),
c74 varchar(2),
c75 varchar(1),
health_prov_taxonomy_code_8 varchar(10),
c77 varchar(20),
c78 varchar(2),
c79 varchar(1),
health_prov_taxonomy_code_9 varchar(10),
c81 varchar(20),
c82 varchar(2),
c83 varchar(1),
health_prov_taxonomy_code_10 varchar(10),
c85 varchar(20),
c86 varchar(2),
c87 varchar(1),
health_prov_taxonomy_code_11 varchar(10),
c89 varchar(20),
c90 varchar(2),
c91 varchar(1),
health_prov_taxonomy_code_12 varchar(10),
c93 varchar(20),
c94 varchar(2),
c95 varchar(1),
health_prov_taxonomy_code_13 varchar(10),
c97 varchar(20),
c98 varchar(2),
c99 varchar(1),
health_prov_taxonomy_code_14 varchar(10),
c101 varchar(20),
c102 varchar(2),
c103 varchar(1),
health_prov_taxonomy_code_15 varchar(10),
c105 varchar(20),
c106 varchar(2),
c107 varchar(1),
c108 varchar(20),
c109 varchar(2),
c110 varchar(2),
c111 varchar(80),
c112 varchar(20),
c113 varchar(2),
c114 varchar(2),
c115 varchar(80),
c116 varchar(20),
c117 varchar(2),
c118 varchar(2),
c119 varchar(80),
c120 varchar(20),
c121 varchar(2),
c122 varchar(2),
c123 varchar(80),
c124 varchar(20),
c125 varchar(2),
c126 varchar(2),
c127 varchar(80),
c128 varchar(20),
c129 varchar(2),
c130 varchar(2),
c131 varchar(80),
c132 varchar(20),
c133 varchar(2),
c134 varchar(2),
c135 varchar(80),
c136 varchar(20),
c137 varchar(2),
c138 varchar(2),
c139 varchar(80),
c140 varchar(20),
c141 varchar(2),
c142 varchar(2),
c143 varchar(80),
c144 varchar(20),
c145 varchar(2),
c146 varchar(2),
c147 varchar(80),
c148 varchar(20),
c149 varchar(2),
c150 varchar(2),
c151 varchar(80),
c152 varchar(20),
c153 varchar(2),
c154 varchar(2),
c155 varchar(80),
c156 varchar(20),
c157 varchar(2),
c158 varchar(2),
c159 varchar(80),
c160 varchar(20),
c161 varchar(2),
c162 varchar(2),
c163 varchar(80),
c164 varchar(20),
c165 varchar(2),
c166 varchar(2),
c167 varchar(80),
c168 varchar(20),
c169 varchar(2),
c170 varchar(2),
c171 varchar(80),
c172 varchar(20),
c173 varchar(2),
c174 varchar(2),
c175 varchar(80),
c176 varchar(20),
c177 varchar(2),
c178 varchar(2),
c179 varchar(80),
c180 varchar(20),
c181 varchar(2),
c182 varchar(2),
c183 varchar(80),
c184 varchar(20),
c185 varchar(2),
c186 varchar(2),
c187 varchar(80),
c188 varchar(20),
c189 varchar(2),
c190 varchar(2),
c191 varchar(80),
c192 varchar(20),
c193 varchar(2),
c194 varchar(2),
c195 varchar(80),
c196 varchar(20),
c197 varchar(2),
c198 varchar(2),
c199 varchar(80),
c200 varchar(20),
c201 varchar(2),
c202 varchar(2),
c203 varchar(80),
c204 varchar(20),
c205 varchar(2),
c206 varchar(2),
c207 varchar(80),
c208 varchar(20),
c209 varchar(2),
c210 varchar(2),
c211 varchar(80),
c212 varchar(20),
c213 varchar(2),
c214 varchar(2),
c215 varchar(80),
c216 varchar(20),
c217 varchar(2),
c218 varchar(2),
c219 varchar(80),
c220 varchar(20),
c221 varchar(2),
c222 varchar(2),
c223 varchar(80),
c224 varchar(20),
c225 varchar(2),
c226 varchar(2),
c227 varchar(80),
c228 varchar(20),
c229 varchar(2),
c230 varchar(2),
c231 varchar(80),
c232 varchar(20),
c233 varchar(2),
c234 varchar(2),
c235 varchar(80),
c236 varchar(20),
c237 varchar(2),
c238 varchar(2),
c239 varchar(80),
c240 varchar(20),
c241 varchar(2),
c242 varchar(2),
c243 varchar(80),
c244 varchar(20),
c245 varchar(2),
c246 varchar(2),
c247 varchar(80),
c248 varchar(20),
c249 varchar(2),
c250 varchar(2),
c251 varchar(80),
c252 varchar(20),
c253 varchar(2),
c254 varchar(2),
c255 varchar(80),
c256 varchar(20),
c257 varchar(2),
c258 varchar(2),
c259 varchar(80),
c260 varchar(20),
c261 varchar(2),
c262 varchar(2),
c263 varchar(80),
c264 varchar(20),
c265 varchar(2),
c266 varchar(2),
c267 varchar(80),
c268 varchar(20),
c269 varchar(2),
c270 varchar(2),
c271 varchar(80),
c272 varchar(20),
c273 varchar(2),
c274 varchar(2),
c275 varchar(80),
c276 varchar(20),
c277 varchar(2),
c278 varchar(2),
c279 varchar(80),
c280 varchar(20),
c281 varchar(2),
c282 varchar(2),
c283 varchar(80),
c284 varchar(20),
c285 varchar(2),
c286 varchar(2),
c287 varchar(80),
c288 varchar(20),
c289 varchar(2),
c290 varchar(2),
c291 varchar(80),
c292 varchar(20),
c293 varchar(2),
c294 varchar(2),
c295 varchar(80),
c296 varchar(20),
c297 varchar(2),
c298 varchar(2),
c299 varchar(80),
c300 varchar(20),
c301 varchar(2),
c302 varchar(2),
c303 varchar(80),
c304 varchar(20),
c305 varchar(2),
c306 varchar(2),
c307 varchar(80),
sole_proprietor varchar(1),
org_subpart varchar(1),
c310 varchar(70),
c311 varchar(9),
c312 varchar(5),
c313 varchar(5),
c314 varchar(20),
c315 varchar(10),
c316 varchar(10),
c317 varchar(10),
c318 varchar(10),
c319 varchar(10),
c320 varchar(10),
c321 varchar(10),
c322 varchar(10),
c323 varchar(10),
c324 varchar(10),
c325 varchar(10),
c326 varchar(10),
c327 varchar(10),
c328 varchar(10),
c329 varchar(10),
cert_date varchar(10));
*/

LOAD DATA INFILE '/Users/jchapman/Downloads/NPPES_Data_Dissemination_September_2022/npidata_pfile_20050523-20220911.csv' IGNORE INTO TABLE npi_npidata
FIELDS TERMINATED BY ',' ENCLOSED BY '"'
LINES TERMINATED BY '\n'
IGNORE 1 LINES
(npi, entity_type_code, replacement_npi, employ_id_nbr, prov_org_name, prov_last_name, prov_first_name, prov_middle_name, prov_name_prefix, prov_name_suffix, prov_cred_text, c12, c13, c14, c15,
c16, c17, c18, c19, c20, c21, c22, c23, c24, c25, c26, c27, c28, c29, c30, c31, c32, c33, c34, c35, c36, c37, c38, npi_deactivation_reason_code, npi_deactivation_date, npi_reactivation_date,
prov_gender_code, c43, c44, c45, authorized_official_title, authorized_official_phone_nbr, health_prov_taxonomy_code_1, c49, c50, c51, health_prov_taxonomy_code_2, c53, c54, c55, health_prov_taxonomy_code_3,
c57, c58, c59, health_prov_taxonomy_code_4, c61, c62, c63, health_prov_taxonomy_code_5, c65, c66, c67, health_prov_taxonomy_code_6, c69, c70, c71, health_prov_taxonomy_code_7, c73, c74, c75,
health_prov_taxonomy_code_8, c77, c78, c79, health_prov_taxonomy_code_9, c81, c82, c83, health_prov_taxonomy_code_10, c85, c86, c87, health_prov_taxonomy_code_11, c89, c90, c91, health_prov_taxonomy_code_12,
c93, c94, c95, health_prov_taxonomy_code_13, c97, c98, c99, health_prov_taxonomy_code_14, c101, c102, c103, health_prov_taxonomy_code_15, c105, c106, c107, c108, c109, c110, c111, c112, c113, c114, c115, c116,
c117, c118, c119, c120, c121, c122, c123, c124, c125, c126, c127, c128, c129, c130, c131, c132, c133, c134, c135, c136, c137, c138, c139, c140, c141, c142, c143, c144, c145, c146, c147, c148, c149, c150, c151,
c152, c153, c154, c155, c156, c157, c158, c159, c160, c161, c162, c163, c164, c165, c166, c167, c168, c169, c170, c171, c172, c173, c174, c175, c176, c177, c178, c179, c180, c181, c182, c183, c184, c185, c186,
c187, c188, c189, c190, c191, c192, c193, c194, c195, c196, c197, c198, c199, c200, c201, c202, c203, c204, c205, c206, c207, c208, c209, c210, c211, c212, c213, c214, c215, c216, c217, c218, c219, c220, c221,
c222, c223, c224, c225, c226, c227, c228, c229, c230, c231, c232, c233, c234, c235, c236, c237, c238, c239, c240, c241, c242, c243, c244, c245, c246, c247, c248, c249, c250, c251, c252, c253, c254, c255, c256,
c257, c258, c259, c260, c261, c262, c263, c264, c265, c266, c267, c268, c269, c270, c271, c272, c273, c274, c275, c276, c277, c278, c279, c280, c281, c282, c283, c284, c285, c286, c287, c288, c289, c290, c291,
c292, c293, c294, c295, c296, c297, c298, c299, c300, c301, c302, c303, c304, c305, c306, c307, sole_proprietor, org_subpart, c310, c311, c312, c313, c314, c315, c316, c317, c318, c319, c320, c321, c322, c323,
c324, c325, c326, c327, c328, c329, cert_date);

--SELECT * FROM npi_npidata;

/*
-- run table counts
SELECT count(*) AS 'npi_data table record count' FROM npi_npidata;

SELECT count(*) AS 'endpoints table record count' FROM npi_endpoints;

SELECT count(*) AS 'other names table record count' FROM npi_otherorgnames;

SELECT count(*) AS 'practice locations table record count' FROM npi_otherpraclocations;
*/