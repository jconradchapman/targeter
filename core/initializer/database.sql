/*
DATABASE.SQL
Targeter v1
MySQL 5.7.32 Database
jchapman - created: 4.18.2022 modified:
*/

-- 1PD: Queries needed to create warehouse tables for client's first party data

-- create table for individuals
CREATE TABLE dw_individuals (
ind_pk INT AUTO_INCREMENT PRIMARY KEY,
ind_ck varchar(50),
ind_type varchar(25),
ind_tag varchar(25),
first_name varchar(50),
last_name varchar(50),
emp_name varchar(50),
ind_title varchar(50),
ind_prefix varchar(10),
ind_suffix varchar(10),
gender varchar(1),
ind_dob date);

-- create table for physical addresses
CREATE TABLE dw_physical_addresses (
physical_address_pk INT AUTO_INCREMENT PRIMARY KEY,
ind_fk INT,
physical_address_type varchar(25),
physical_address_tag varchar(25),
address_line1 varchar(100),
address_line2 varchar(100),
city varchar(50),
state varchar(50),
postal_code varchar(50),
phone1 varchar(50),
phone2 varchar(50));

-- create table for online addresses
CREATE TABLE dw_online_addresses (
online_address_pk INT AUTO_INCREMENT PRIMARY KEY,
ind_fk INT,
online_address_type varchar(25),
online_address_tag varchar(25),
online_address varchar(100));

-- create table for transactions
CREATE TABLE dw_transactions (
transaction_pk INT AUTO_INCREMENT PRIMARY KEY,
ind_fk INT,
transaction_type varchar(25),
transaction_tag varchar(25),
transaction_value float,
transaction_date date);

-- create table for scores
CREATE TABLE dw_scores (
score_pk INT AUTO_INCREMENT PRIMARY KEY,
ind_fk INT,
score_type varchar(25),
score_tag varchar(25),
score float,
score_date date);

-- NPPES NPI: Queries needed to create data tables

-- create table for HCPs
-- allow for large table creation
SET GLOBAL innodb_default_row_format='dynamic';
SET SESSION innodb_strict_mode=OFF;

CREATE TABLE npi_npidata (
npidata_id INT AUTO_INCREMENT PRIMARY KEY,
npi INT,
entity_type_code INT,
replacement_npi INT,
employ_id_nbr varchar(9),
prov_org_name varchar(70),
prov_last_name varchar(35),
prov_first_name varchar(20),
prov_middle_name varchar(20),
prov_name_prefix varchar(5),
prov_name_suffix varchar(5),
prov_cred_text varchar(20),
c12 varchar(70),
c13 varchar(1),
c14 varchar(35),
c15 varchar(20),
c16 varchar(20),
c17 varchar(5),
c18 varchar(5),
c19 varchar(20),
c20 INT,
c21 varchar(55),
c22 varchar(55),
c23 varchar(40),
c24 varchar(40),
c25 varchar(20),
c26 varchar(2),
c27 varchar(20),
c28 varchar(20),
c29 varchar(55),
c30 varchar(55),
c31 varchar(40),
c32 varchar(40),
c33 varchar(20),
c34 varchar(2),
c35 varchar(20),
c36 varchar(20),
c37 varchar(10),
c38 varchar(10),
npi_deactivation_reason_code varchar(2),
npi_deactivation_date varchar(10),
npi_reactivation_date varchar(10),
prov_gender_code varchar(1),
c43 varchar(35),
c44 varchar(20),
c45 varchar(20),
authorized_official_title varchar(35),
authorized_official_phone_nbr varchar(20),
health_prov_taxonomy_code_1 varchar(10),
c49 varchar(20),
c50 varchar(2),
c51 varchar(1),
health_prov_taxonomy_code_2 varchar(10),
c53 varchar(20),
c54 varchar(2),
c55 varchar(1),
health_prov_taxonomy_code_3 varchar(10),
c57 varchar(20),
c58 varchar(2),
c59 varchar(1),
health_prov_taxonomy_code_4 varchar(10),
c61 varchar(20),
c62 varchar(2),
c63 varchar(1),
health_prov_taxonomy_code_5 varchar(10),
c65 varchar(20),
c66 varchar(2),
c67 varchar(1),
health_prov_taxonomy_code_6 varchar(10),
c69 varchar(20),
c70 varchar(2),
c71 varchar(1),
health_prov_taxonomy_code_7 varchar(10),
c73 varchar(20),
c74 varchar(2),
c75 varchar(1),
health_prov_taxonomy_code_8 varchar(10),
c77 varchar(20),
c78 varchar(2),
c79 varchar(1),
health_prov_taxonomy_code_9 varchar(10),
c81 varchar(20),
c82 varchar(2),
c83 varchar(1),
health_prov_taxonomy_code_10 varchar(10),
c85 varchar(20),
c86 varchar(2),
c87 varchar(1),
health_prov_taxonomy_code_11 varchar(10),
c89 varchar(20),
c90 varchar(2),
c91 varchar(1),
health_prov_taxonomy_code_12 varchar(10),
c93 varchar(20),
c94 varchar(2),
c95 varchar(1),
health_prov_taxonomy_code_13 varchar(10),
c97 varchar(20),
c98 varchar(2),
c99 varchar(1),
health_prov_taxonomy_code_14 varchar(10),
c101 varchar(20),
c102 varchar(2),
c103 varchar(1),
health_prov_taxonomy_code_15 varchar(10),
c105 varchar(20),
c106 varchar(2),
c107 varchar(1),
c108 varchar(20),
c109 varchar(2),
c110 varchar(2),
c111 varchar(80),
c112 varchar(20),
c113 varchar(2),
c114 varchar(2),
c115 varchar(80),
c116 varchar(20),
c117 varchar(2),
c118 varchar(2),
c119 varchar(80),
c120 varchar(20),
c121 varchar(2),
c122 varchar(2),
c123 varchar(80),
c124 varchar(20),
c125 varchar(2),
c126 varchar(2),
c127 varchar(80),
c128 varchar(20),
c129 varchar(2),
c130 varchar(2),
c131 varchar(80),
c132 varchar(20),
c133 varchar(2),
c134 varchar(2),
c135 varchar(80),
c136 varchar(20),
c137 varchar(2),
c138 varchar(2),
c139 varchar(80),
c140 varchar(20),
c141 varchar(2),
c142 varchar(2),
c143 varchar(80),
c144 varchar(20),
c145 varchar(2),
c146 varchar(2),
c147 varchar(80),
c148 varchar(20),
c149 varchar(2),
c150 varchar(2),
c151 varchar(80),
c152 varchar(20),
c153 varchar(2),
c154 varchar(2),
c155 varchar(80),
c156 varchar(20),
c157 varchar(2),
c158 varchar(2),
c159 varchar(80),
c160 varchar(20),
c161 varchar(2),
c162 varchar(2),
c163 varchar(80),
c164 varchar(20),
c165 varchar(2),
c166 varchar(2),
c167 varchar(80),
c168 varchar(20),
c169 varchar(2),
c170 varchar(2),
c171 varchar(80),
c172 varchar(20),
c173 varchar(2),
c174 varchar(2),
c175 varchar(80),
c176 varchar(20),
c177 varchar(2),
c178 varchar(2),
c179 varchar(80),
c180 varchar(20),
c181 varchar(2),
c182 varchar(2),
c183 varchar(80),
c184 varchar(20),
c185 varchar(2),
c186 varchar(2),
c187 varchar(80),
c188 varchar(20),
c189 varchar(2),
c190 varchar(2),
c191 varchar(80),
c192 varchar(20),
c193 varchar(2),
c194 varchar(2),
c195 varchar(80),
c196 varchar(20),
c197 varchar(2),
c198 varchar(2),
c199 varchar(80),
c200 varchar(20),
c201 varchar(2),
c202 varchar(2),
c203 varchar(80),
c204 varchar(20),
c205 varchar(2),
c206 varchar(2),
c207 varchar(80),
c208 varchar(20),
c209 varchar(2),
c210 varchar(2),
c211 varchar(80),
c212 varchar(20),
c213 varchar(2),
c214 varchar(2),
c215 varchar(80),
c216 varchar(20),
c217 varchar(2),
c218 varchar(2),
c219 varchar(80),
c220 varchar(20),
c221 varchar(2),
c222 varchar(2),
c223 varchar(80),
c224 varchar(20),
c225 varchar(2),
c226 varchar(2),
c227 varchar(80),
c228 varchar(20),
c229 varchar(2),
c230 varchar(2),
c231 varchar(80),
c232 varchar(20),
c233 varchar(2),
c234 varchar(2),
c235 varchar(80),
c236 varchar(20),
c237 varchar(2),
c238 varchar(2),
c239 varchar(80),
c240 varchar(20),
c241 varchar(2),
c242 varchar(2),
c243 varchar(80),
c244 varchar(20),
c245 varchar(2),
c246 varchar(2),
c247 varchar(80),
c248 varchar(20),
c249 varchar(2),
c250 varchar(2),
c251 varchar(80),
c252 varchar(20),
c253 varchar(2),
c254 varchar(2),
c255 varchar(80),
c256 varchar(20),
c257 varchar(2),
c258 varchar(2),
c259 varchar(80),
c260 varchar(20),
c261 varchar(2),
c262 varchar(2),
c263 varchar(80),
c264 varchar(20),
c265 varchar(2),
c266 varchar(2),
c267 varchar(80),
c268 varchar(20),
c269 varchar(2),
c270 varchar(2),
c271 varchar(80),
c272 varchar(20),
c273 varchar(2),
c274 varchar(2),
c275 varchar(80),
c276 varchar(20),
c277 varchar(2),
c278 varchar(2),
c279 varchar(80),
c280 varchar(20),
c281 varchar(2),
c282 varchar(2),
c283 varchar(80),
c284 varchar(20),
c285 varchar(2),
c286 varchar(2),
c287 varchar(80),
c288 varchar(20),
c289 varchar(2),
c290 varchar(2),
c291 varchar(80),
c292 varchar(20),
c293 varchar(2),
c294 varchar(2),
c295 varchar(80),
c296 varchar(20),
c297 varchar(2),
c298 varchar(2),
c299 varchar(80),
c300 varchar(20),
c301 varchar(2),
c302 varchar(2),
c303 varchar(80),
c304 varchar(20),
c305 varchar(2),
c306 varchar(2),
c307 varchar(80),
sole_proprietor varchar(1),
org_subpart varchar(1),
c310 varchar(70),
c311 varchar(9),
c312 varchar(5),
c313 varchar(5),
c314 varchar(20),
c315 varchar(10),
c316 varchar(10),
c317 varchar(10),
c318 varchar(10),
c319 varchar(10),
c320 varchar(10),
c321 varchar(10),
c322 varchar(10),
c323 varchar(10),
c324 varchar(10),
c325 varchar(10),
c326 varchar(10),
c327 varchar(10),
c328 varchar(10),
c329 varchar(10),
cert_date varchar(10));

-- create table for other org names
CREATE TABLE npi_otherorgnames (
othername_id INT AUTO_INCREMENT PRIMARY KEY,
npi INT,
prov_othr_org_name varchar(120),
prov_othr_org_name_type varchar(1));

-- create table for practice locations
CREATE TABLE npi_otherpraclocations (
other_prac_loc_id INT AUTO_INCREMENT PRIMARY KEY,
npi INT,
address_line_1 varchar(55),
address_line_2 varchar(55),
city varchar(40),
state varchar(40),
postal_code varchar(20),
country varchar(2),
telephone_nbr varchar(20),
telephone_ext varchar(5),
fax_nbr varchar(20));

-- create table for endpoints
CREATE TABLE npi_endpoints (
endpoint_id INT AUTO_INCREMENT PRIMARY KEY,
npi INT,
endpoint_type varchar(50),
endpoint_type_desc varchar(255),
endpoint varchar(1000),
affiliation varchar(1),
endpoint_desc varchar(1000),
affiliation_legal_bus_name varchar(70),
use_code varchar(25),
use_desc varchar(100),
other_use_desc varchar(200),
content_type varchar(25),
content_desc varchar(100),
other_content_desc varchar(200),
affiliation_address_line_1 varchar(55),
affiliation_address_line_2 varchar(55),
affiliation_address_city varchar(40),
affiliation_address_state varchar(40),
affiliation_address_country varchar(2),
affiliation_address_postal_code varchar(55));


-- CMS DE-SynPUF: Queries needed to create data tables

-- create table for beneficiaries
CREATE TABLE ts_cms_desynpuf_beneficiaries (
beneficiary_pk INT AUTO_INCREMENT PRIMARY KEY,
desynpuf_id varchar(50),
bene_birth_dt varchar(50),
bene_death_dt varchar(50),
bene_sex_ident_cd varchar(50),
bene_race_cd varchar(50),
bene_esrd_ind varchar(50),
sp_state_code varchar(50),
bene_county_cd varchar(50),
bene_hi_cvrage_tot_mons varchar(50),
bene_smi_cvrage_tot_mons varchar(50),
bene_hmo_cvrage_tot_mons varchar(50),
plan_cvrg_mos_num varchar(50),
sp_alzhdmta varchar(50),
sp_chf varchar(50),
sp_chrnkidn varchar(50),
sp_cncr varchar(50),
sp_copd varchar(50),
sp_depressn varchar(50),
sp_diabetes varchar(50),
sp_ischmcht varchar(50),
sp_osteoprs varchar(50),
sp_ra_oa varchar(50),
sp_strketia varchar(50),
medreimb_ip varchar(50),
benres_ip varchar(50),
pppymt_ip varchar(50),
medreimb_op varchar(50),
benres_op varchar(50),
pppymt_op varchar(50),
medreimb_car varchar(50),
benres_car varchar(50),
pppymt_car varchar(50));


-- create table for inpatient_claims
CREATE TABLE ts_cms_desynpuf_inpat_claims (
inpat_claims_pk INT AUTO_INCREMENT PRIMARY KEY,
desynpuf_id varchar(50),
clm_id varchar(50),
segment varchar(50),
clm_from_dt varchar(50),
clm_thru_dt varchar(50),
prvdr_num varchar(50),
clm_pmt_amt varchar(50),
nch_prmry_pyr_clm_pd_amt varchar(50),
at_physn_npi int,
op_physn_npi int,
ot_physn_npi int,
clm_admsn_dt varchar(50),
admtng_icd9_dgns_cd varchar(50),
clm_pass_thru_per_diem_amt varchar(50),
nch_bene_ip_ddctbl_amt varchar(50),
nch_bene_pta_coinsrnc_lblty_am varchar(50),
nch_bene_blood_ddctbl_lblty_am varchar(50),
clm_utlztn_day_cnt varchar(50),
nch_bene_dschrg_dt varchar(50),
clm_drg_cd varchar(50),
icd9_dgns_cd_1 varchar(50),
icd9_dgns_cd_2 varchar(50),
icd9_dgns_cd_3 varchar(50),
icd9_dgns_cd_4 varchar(50),
icd9_dgns_cd_5 varchar(50),
icd9_dgns_cd_6 varchar(50),
icd9_dgns_cd_7 varchar(50),
icd9_dgns_cd_8 varchar(50),
icd9_dgns_cd_9 varchar(50),
icd9_dgns_cd_10 varchar(50),
icd9_prcdr_cd_1 varchar(50),
icd9_prcdr_cd_2 varchar(50),
icd9_prcdr_cd_3 varchar(50),
icd9_prcdr_cd_4 varchar(50),
icd9_prcdr_cd_5 varchar(50),
icd9_prcdr_cd_6 varchar(50),
hcpcs_cd_1 varchar(50),
hcpcs_cd_2 varchar(50),
hcpcs_cd_3 varchar(50),
hcpcs_cd_4 varchar(50),
hcpcs_cd_5 varchar(50),
hcpcs_cd_6 varchar(50),
hcpcs_cd_7 varchar(50),
hcpcs_cd_8 varchar(50),
hcpcs_cd_9 varchar(50),
hcpcs_cd_10 varchar(50),
hcpcs_cd_11 varchar(50),
hcpcs_cd_12 varchar(50),
hcpcs_cd_13 varchar(50),
hcpcs_cd_14 varchar(50),
hcpcs_cd_15 varchar(50),
hcpcs_cd_16 varchar(50),
hcpcs_cd_17 varchar(50),
hcpcs_cd_18 varchar(50),
hcpcs_cd_19 varchar(50),
hcpcs_cd_20 varchar(50),
hcpcs_cd_21 varchar(50),
hcpcs_cd_22 varchar(50),
hcpcs_cd_23 varchar(50),
hcpcs_cd_24 varchar(50),
hcpcs_cd_25 varchar(50),
hcpcs_cd_26 varchar(50),
hcpcs_cd_27 varchar(50),
hcpcs_cd_28 varchar(50),
hcpcs_cd_29 varchar(50),
hcpcs_cd_30 varchar(50),
hcpcs_cd_31 varchar(50),
hcpcs_cd_32 varchar(50),
hcpcs_cd_33 varchar(50),
hcpcs_cd_34 varchar(50),
hcpcs_cd_35 varchar(50),
hcpcs_cd_36 varchar(50),
hcpcs_cd_37 varchar(50),
hcpcs_cd_38 varchar(50),
hcpcs_cd_39 varchar(50),
hcpcs_cd_40 varchar(50),
hcpcs_cd_41 varchar(50),
hcpcs_cd_42 varchar(50),
hcpcs_cd_43 varchar(50),
hcpcs_cd_44 varchar(50),
hcpcs_cd_45 varchar(50));


-- create table for outpatient_claims
CREATE TABLE ts_cms_desynpuf_outpat_claims (
outpat_claims_pk INT AUTO_INCREMENT PRIMARY KEY,
desynpuf_id varchar(50),
clm_id varchar(50),
segment varchar(50),
clm_from_dt varchar(50),
clm_thru_dt varchar(50),
prvdr_num varchar(50),
clm_pmt_amt varchar(50),
nch_prmry_pyr_clm_pd_amt varchar(50),
at_physn_npi int,
op_physn_npi int,
ot_physn_npi int,
nch_bene_blood_ddctbl_lblty_am varchar(50),
icd9_dgns_cd_1 varchar(50),
icd9_dgns_cd_2 varchar(50),
icd9_dgns_cd_3 varchar(50),
icd9_dgns_cd_4 varchar(50),
icd9_dgns_cd_5 varchar(50),
icd9_dgns_cd_6 varchar(50),
icd9_dgns_cd_7 varchar(50),
icd9_dgns_cd_8 varchar(50),
icd9_dgns_cd_9 varchar(50),
icd9_dgns_cd_10 varchar(50),
icd9_prcdr_cd_1 varchar(50),
icd9_prcdr_cd_2 varchar(50),
icd9_prcdr_cd_3 varchar(50),
icd9_prcdr_cd_4 varchar(50),
icd9_prcdr_cd_5 varchar(50),
icd9_prcdr_cd_6 varchar(50),
nch_bene_ptb_ddctbl_amt varchar(50),
nch_bene_ptb_coinsrnc_amt varchar(50),
admtng_icd9_dgns_cd varchar(50),
hcpcs_cd_1 varchar(50),
hcpcs_cd_2 varchar(50),
hcpcs_cd_3 varchar(50),
hcpcs_cd_4 varchar(50),
hcpcs_cd_5 varchar(50),
hcpcs_cd_6 varchar(50),
hcpcs_cd_7 varchar(50),
hcpcs_cd_8 varchar(50),
hcpcs_cd_9 varchar(50),
hcpcs_cd_10 varchar(50),
hcpcs_cd_11 varchar(50),
hcpcs_cd_12 varchar(50),
hcpcs_cd_13 varchar(50),
hcpcs_cd_14 varchar(50),
hcpcs_cd_15 varchar(50),
hcpcs_cd_16 varchar(50),
hcpcs_cd_17 varchar(50),
hcpcs_cd_18 varchar(50),
hcpcs_cd_19 varchar(50),
hcpcs_cd_20 varchar(50),
hcpcs_cd_21 varchar(50),
hcpcs_cd_22 varchar(50),
hcpcs_cd_23 varchar(50),
hcpcs_cd_24 varchar(50),
hcpcs_cd_25 varchar(50),
hcpcs_cd_26 varchar(50),
hcpcs_cd_27 varchar(50),
hcpcs_cd_28 varchar(50),
hcpcs_cd_29 varchar(50),
hcpcs_cd_30 varchar(50),
hcpcs_cd_31 varchar(50),
hcpcs_cd_32 varchar(50),
hcpcs_cd_33 varchar(50),
hcpcs_cd_34 varchar(50),
hcpcs_cd_35 varchar(50),
hcpcs_cd_36 varchar(50),
hcpcs_cd_37 varchar(50),
hcpcs_cd_38 varchar(50),
hcpcs_cd_39 varchar(50),
hcpcs_cd_40 varchar(50),
hcpcs_cd_41 varchar(50),
hcpcs_cd_42 varchar(50),
hcpcs_cd_43 varchar(50),
hcpcs_cd_44 varchar(50),
hcpcs_cd_45 varchar(50));


-- create table for carrier_claims
CREATE TABLE ts_cms_desynpuf_carrier_claims (
carrier_claims_pk INT AUTO_INCREMENT PRIMARY KEY,
desynpuf_id varchar(50),
clm_id varchar(50),
clm_from_dt varchar(50),
clm_thru_dt varchar(50),
icd9_dgns_cd_1 varchar(50),
icd9_dgns_cd_2 varchar(50),
icd9_dgns_cd_3 varchar(50),
icd9_dgns_cd_4 varchar(50),
icd9_dgns_cd_5 varchar(50),
icd9_dgns_cd_6 varchar(50),
icd9_dgns_cd_7 varchar(50),
icd9_dgns_cd_8 varchar(50),
prf_physn_npi_1 int,
prf_physn_npi_2 int,
prf_physn_npi_3 int,
prf_physn_npi_4 int,
prf_physn_npi_5 int,
prf_physn_npi_6 int,
prf_physn_npi_7 int,
prf_physn_npi_8 int,
prf_physn_npi_9 int,
prf_physn_npi_10 int,
prf_physn_npi_11 int,
prf_physn_npi_12 int,
prf_physn_npi_13 int,
hcpcs_cd_1 varchar(50),
hcpcs_cd_2 varchar(50),
hcpcs_cd_3 varchar(50),
hcpcs_cd_4 varchar(50),
hcpcs_cd_5 varchar(50),
hcpcs_cd_6 varchar(50),
hcpcs_cd_7 varchar(50),
hcpcs_cd_8 varchar(50),
hcpcs_cd_9 varchar(50),
hcpcs_cd_10 varchar(50),
hcpcs_cd_11 varchar(50),
hcpcs_cd_12 varchar(50),
hcpcs_cd_13 varchar(50),
line_icd9_dgns_cd_1 varchar(50), 
line_icd9_dgns_cd_2 varchar(50),
line_icd9_dgns_cd_3 varchar(50),
line_icd9_dgns_cd_4 varchar(50),
line_icd9_dgns_cd_5 varchar(50),
line_icd9_dgns_cd_6 varchar(50),
line_icd9_dgns_cd_7 varchar(50),
line_icd9_dgns_cd_8 varchar(50),
line_icd9_dgns_cd_9 varchar(50),
line_icd9_dgns_cd_10 varchar(50),
line_icd9_dgns_cd_11 varchar(50),
line_icd9_dgns_cd_12 varchar(50),
line_icd9_dgns_cd_13 varchar(50));


-- create table for and load prescriptions
CREATE TABLE ts_cms_desynpuf_prescrib_events (
prescribe_events_pk INT AUTO_INCREMENT PRIMARY KEY,
desynpuf_id varchar(50),
pde_id varchar(50),
srvc_dt varchar(50),
prod_srvc_id varchar(50),
qty_dspnsd_num varchar(50),
days_suply_num varchar(50),
ptnt_pay_amt varchar(50),
tot_rx_cst_amt varchar(50));
